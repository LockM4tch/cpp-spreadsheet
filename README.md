# Spreadsheet (Электронная таблица)

## Описание
Проект представляет собой реализацию электронных таблиц, поддерживающих базовые вычисления и работу с формулами.

Целью данного проекта было упражнение с использованием библиотеки ANTLR для парсинга формул и их последующей интерпретации. Проект написан на C++ и использует CMake для сборки, а также библиотеку ANTLR для генерации AST (Абстрактного Синтаксического Дерева) на основе грамматического описания формул.

**Технологический стек**:
- C++
- CMake
- ANTLR4 C++ Runtime

## Функциональность
- Поддержка формул для выполнения математических операций.
- Поддержка работы с ячейками таблицы (ввод и изменение значений).
- Интерпретация и вычисление формул с использованием ANTLR.

## Системные требования
- C++17 или новее.
- ANTLR4 C++ Runtime.
- CMake 3.10 или новее.

### Инструкция по развёртыванию
1. Скачайте архив с библиотекой ANTLR4 C++ Runtime:
   - Перейдите на [официальный сайт ANTLR](https://www.antlr.org/download.html).
   - Скачайте архив `antlr4-cpp-runtime*.zip` и распакуйте его в папку `antlr4_runtime` в корне проекта.

2. Установите Java и ANTLR JAR:
   - Скачайте `antlr-4.12.0-complete.jar` или другую актуальную версию из [раздела загрузки ANTLR](https://www.antlr.org/download.html).
   - Разместите JAR-файл в корневой папке проекта.
  -  Не забудьте изменить строку set(ANTLR_EXECUTABLE ${CMAKE_CURRENT_SOURCE_DIR}/antlr-4.7.2-complete.jar) в CMakeLists, на используемую версию antlr либо переименуйте ваш antlr*.jar в в antlr-4.7.2-complete.jar


3. Скомпилируйте проект:
-  mkdir build
-  cd build
-  cmake ..
-  make


## Планы по доработке
- Улучшить обработку ошибок парсинга с помощью расширения механизмов ANTLR.
- Добавить поддержку дополнительных математических операций и функций для расширения возможностей формул.
- Оптимизировать производительность при работе с большими объемами данных в таблице.

## Структура проекта
- `CMakeLists.txt` — основной файл сборки проекта с CMake.
- `FindANTLR.cmake` — файл для интеграции ANTLR с CMake.
- `Formula.g4` — грамматическое описание формул для ANTLR.
- `FormulaAST.cpp`/`FormulaAST.h` — реализация AST (Абстрактного Синтаксического Дерева) для формул.
- `cell.cpp`/`cell.h` — работа с ячейками таблицы.
- `formula.cpp`/`formula.h` — обработка и вычисление формул.
- `main.cpp` — точка входа в программу.
- `sheet.cpp`/`sheet.h` — реализация электронной таблицы.
- `test_runner_p.h` — вспомогательный файл для тестирования.

В файле `FindANTLR.cmake` содержатся команды для генерации файлов ANTLR, которые подключаются к основному CMake-файлу командой:
```cmake
include(${CMAKE_CURRENT_SOURCE_DIR}/FindANTLR.cmake)
```

### Структура проекта:
```
spreadsheet/
├── antlr4_runtime/
│   └── Содержимое архива antlr4-cpp-runtime*.zip.
├── build/
├── antlr-4.12.0-complete.jar
├── CMakeLists.txt
├── FindANTLR.cmake
├── Formula.g4
├── Остальные файлы проекта
└── ...
```

Проект готов к дальнейшему развитию и использованию в учебных или экспериментальных целях.
